# クラス  

クラスとは、アプリの中である特定の機能を担うかたまりであり、C#のアプリはクラスの集合である。  

<br>

## オブジェクト指向プログラミング  

オブジェクト指向プログラミングとは、機能をクラスにまとめて、クラスの集合体としてアプリケーションを構築していく手法を指す。  
現代で使用されている主なプログラム言語は大体がオブジェクト指向プログラミング言語である。  
例：C#, Java, C++, TypeScript  

逆に機能をまとめずに、単純にソースコードを上から順に実行するプログラム言語はスクリプト型言語と言ったりするが、大体の言語はオブジェクト指向プログラミングもできる仕様になっている。  
例：C, Python, JavaScript  

[オブジェクト指向プログラミング](https://ja.wikipedia.org/wiki/%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E6%8C%87%E5%90%91%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0)  

<br>

## クラスの定義  

クラスの定義は以下のように記述する。  

```CSharp
[修飾子] class クラス名
{
    クラスの内容
}
```  

例：  

```CSharp
public class Person
{

}
```  

※修飾子は後述  

<br>

### クラス名  

クラス名に対して適切な名前をつけることは、コードの可読性/保守性を保つために重要である。  
クラスの名前は、プログラムだけでなくクラス図などの仕様書内にも登場するので、多数の開発者が目にすることになる。  
クラス図とは、クラス配下のメンバーやクラス同士の関係を表す図のことである。  

![class図](./Resources/class図.PNG)  

- Pascal記法で統一  
全ての単語を大文字で始める記法である。String builderクラスを作成したい場合は、StringBuilderと記述する。  

- 対称/機能が明確となるような単語を選定する  

<br>

### 修飾子  

修飾子は、クラスやそのメンバーの性質を決めるキーワードである。  
付与できる修飾子は、クラス、フィールド/メソッドなど、対称となる要素によって異なる。  
以下はクラスに利用できる修飾子である。  

| 修飾子   |     概要      |
| --- | ----------- |
| public    | 全てのクラスからアクセス可能 |
| internal    | 同じアセンブリ内からのみアクセス可能 |
| abstract    | 抽象メンバーを指定 |
| static    | 静的メンバーを指定 |
| sealded    | 他のクラスから継承できない |  

internalの同じアセンブリとは、複数のアプリケーションを連携して使用する場合などに、別のアプリケーションからアクセスできないことを示す。  

abstract、static、sealedについては後述する。  

<br>

### メンバ変数  

クラスの中で宣言される変数を***メンバ変数***という。これは、クラス内で有効な変数となる。  

```CSharp
class Sample{
    int a = 1;
    string str = "test";
}
```

このようなSampleクラスがあるとき、"a"や"str"はメンバ変数となる。  

<br>

### メンバ関数  

メンバ変数同様、クラスないで宣言される関数をメンバ関数という。  

```CSharp
class Sample{
    public void test1(){
        // メソッド内の処理を記述
    }
}
```

***テスト***  
タイヤ、ハンドルという変数と、停止、発車という関数を持つクラスを作成する。  

<br>

### クラスとインスタンス  

クラスを作成したら、そのクラスを利用する必要がある。  
クラスを利用するには、クラスの実体(インスタンス)を作る必要がある。  

```CSharp
クラス名 変数名;    // クラスを格納する変数
変数 = new クラス名();
```  

このように記述することで、インスタンスを生成することができる。  
通常の変数と同じように、宣言と同様に初期化することもできる。  

```CSharp
クラス名 変数名 = new クラス名();
```  

インスタンスからメンバ変数、メンバ関数を利用する際は、以下のように記述する。  

```CSharp
変数名.メンバ名
```  

ここまでの部分のサンプル。  

```CSharp
class Program
{
    static void Main(string[] args)
    {
        Vehicle car = new Vehicle();
        car.Start();
        car.Stop();
    }
}

class Vehicle
{
    int tire;
    private int handle;

    public void Start()
    {
        Console.WriteLine("Start");
    }

    public void Stop()
    {
        Console.WriteLine("Stop");
    }
}
// 実行結果
// Start
// Stop
```  

***メンバのアクセス修飾子***  

[参考](https://itsakura.com/csharp-access-modifiers)  

覚えておくのは２つ。  
***private***：そのクラス内からのみアクセス可能。  
***public***：別のクラスからアクセス可能。  
***修飾子を省略した場合***：private扱い。  

上記のサンプルでは、```public```が付いている```Start()```と```Stop()```には、別のクラスからアクセスできるが、何もついていない```tire```と```private```が付いている```handle```は外部クラスからアクセスできない。  

```CSharp
Vehicle car = new Vehicle();
car.Start();        // OK
car.Stop();         // OK
int tireNum = car.tire;     // NG コンパイルエラー
car.tire = 4;               // NG コンパイルエラー
int handleNum = car.handle; // NG コンパイルエラー
car.handle = 1;             // NG コンパイルエラー
```  

***テスト***  

以下のクラスを利用して、自転車クラスと自動車クラスを作成する。  
このとき、タイヤの数と名前を代入し、ShowDetail関数を実行する。  

```CSharp
class Vehicle
{
    private int handle = 1;
    public int tire;
    public string name;

    public void ShowDetail()
    {
        Console.WriteLine($"名前：{name}");
        Console.WriteLine($"タイヤの数：{tire}");
        Console.WriteLine($"ハンドルの数：{handle}");

    }

    public void Start()
    {
        Console.WriteLine("発車します");
    }

    public void Stop()
    {
        Console.WriteLine("停車します");
    }
}
/* 実行結果
名前：自動車
タイヤの数：4
ハンドルの数：1
名前：自転車
タイヤの数：2
ハンドルの数：1
*/
```  

